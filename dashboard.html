<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exit Targets Dashboard</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel (for JSX) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Firebase Compat SDKs (v10.7.1) -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <style>
        @keyframes fall {
            0% { transform: translateY(-100%) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        .animate-fall { animation-name: fall; animation-timing-function: linear; }
        .animate-shimmer { animation: shimmer 2s infinite linear; }
        
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        /* Initial Loader Styles */
        #loader { display: flex; height: 100vh; width: 100vw; align-items: center; justify-content: center; background: #f8fafc; color: #475569; font-family: sans-serif; flex-direction: column; gap: 20px; }
        .spinner { width: 40px; height: 40px; border: 4px solid #e2e8f0; border-top: 4px solid #4f46e5; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        #error-box { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 9999; padding: 40px; box-sizing: border-box; overflow: auto; }
    </style>
</head>
<body class="bg-slate-100">
    
    <!-- Initial Loader (Visible until React takes over) -->
    <div id="root">
        <div id="loader">
            <div class="spinner"></div>
            <div>Loading Dashboard...</div>
            <div style="font-size: 12px; color: #94a3b8; margin-top: 10px;">Syncing with cloud...</div>
        </div>
    </div>

    <!-- Global Error Handler -->
    <div id="error-box">
        <h2 style="color: #dc2626; font-size: 24px; margin-bottom: 16px; font-family: sans-serif;">Something went wrong</h2>
        <p style="font-family: sans-serif; color: #475569; margin-bottom: 20px;">The dashboard failed to start. Here is the error:</p>
        <pre id="error-content" style="background: #f1f5f9; padding: 20px; border-radius: 8px; color: #334155; font-family: monospace; white-space: pre-wrap;"></pre>
    </div>

    <script>
        window.onerror = function(message, source, lineno, colno, error) {
            document.getElementById('loader').style.display = 'none';
            document.getElementById('error-box').style.display = 'block';
            document.getElementById('error-content').textContent = `Error: ${message}\n\nSource: ${source}:${lineno}`;
        };
    </script>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- CONFIGURATION LOGIC ---
        let firebaseConfig;
        let currentAppId = "exit-targets-app";
        let initialToken = "";

        // 1. Try Environment Config (For Preview Mode)
        if (typeof __firebase_config !== 'undefined') {
            try {
                firebaseConfig = JSON.parse(__firebase_config);
                if (typeof __app_id !== 'undefined') currentAppId = __app_id;
                if (typeof __initial_auth_token !== 'undefined') initialToken = __initial_auth_token;
            } catch (e) { console.error("Env config parse error", e); }
        }

        // 2. Fallback to Manual Config (For Local/Production)
        // ⚠️ PASTE YOUR FIREBASE CONFIG HERE IF RUNNING LOCALLY
        if (!firebaseConfig) {
            firebaseConfig = {
                  apiKey: "AIzaSyDfNkGyQSPBB-XSTwovWUjvbiXgb72Ctds",
                    authDomain: "dashboard-3ee49.firebaseapp.com",
                    projectId: "dashboard-3ee49",
                    storageBucket: "dashboard-3ee49.firebasestorage.app",
                    messagingSenderId: "249275818340",
                    appId: "1:249275818340:web:f8fff4c931afa6ddc41a71",
                    measurementId: "G-GPJJHMCK4K"
            };
        }

        // --- Firebase Init ---
        if (!firebase.apps.length && firebaseConfig && firebaseConfig.apiKey !== "YOUR_API_KEY") {
            try {
                firebase.initializeApp(firebaseConfig);
            } catch (e) {
                console.error("Firebase Init Error:", e);
                throw new Error("Failed to initialize Firebase: " + e.message);
            }
        }
        
        const auth = firebase.apps.length ? firebase.auth() : null;
        const db = firebase.apps.length ? firebase.firestore() : null;

        // --- Icons Components ---
        const IconWrapper = ({ d, className, size = 24, fill="none" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill={fill} stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{d}</svg>
        );

        const CheckCircle2 = (p) => <IconWrapper {...p} d={<><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></>} />;
        const Circle = (p) => <IconWrapper {...p} d={<circle cx="12" cy="12" r="10"/>} />;
        const Video = (p) => <IconWrapper {...p} d={<><path d="m22 8-6 4 6 4V8Z"/><rect width="14" height="12" x="2" y="6" rx="2" ry="2"/></>} />;
        const Files = (p) => <IconWrapper {...p} d={<><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/></>} />;
        const FileText = (p) => <IconWrapper {...p} d={<><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" x2="8" y1="13" y2="13"/><line x1="16" x2="8" y1="17" y2="17"/><line x1="10" x2="8" y1="9" y2="9"/></>} />;
        const Phone = (p) => <IconWrapper {...p} d={<path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>} />;
        const HardDrive = (p) => <IconWrapper {...p} d={<><line x1="22" x2="2" y1="12" y2="12"/><path d="M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"/><line x1="6" x2="6.01" y1="16" y2="16"/><line x1="10" x2="10.01" y1="16" y2="16"/></>} />;
        const Scissors = (p) => <IconWrapper {...p} d={<><circle cx="6" cy="6" r="3"/><circle cx="6" cy="18" r="3"/><line x1="20" x2="8.12" y1="4" y2="15.88"/><line x1="14.47" x2="20" y1="14.48" y2="20"/><line x1="8.12" x2="12" y1="8.12" y2="12"/></>} />;
        const Trophy = (p) => <IconWrapper {...p} d={<><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></>} />;
        const Rocket = (p) => <IconWrapper {...p} d={<><path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"/><path d="m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"/><path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"/><path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"/></>} />;
        const RotateCcw = (p) => <IconWrapper {...p} d={<><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></>} />;
        const Layout = (p) => <IconWrapper {...p} d={<><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><line x1="3" x2="21" y1="9" y2="9"/><line x1="9" x2="9" y1="21" y2="9"/></>} />;
        const Activity = (p) => <IconWrapper {...p} d={<path d="M22 12h-4l-3 9L9 3l-3 9H2"/>} />;
        const Target = (p) => <IconWrapper {...p} d={<><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></>} />;
        const Award = (p) => <IconWrapper {...p} d={<><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></>} />;
        const Save = (p) => <IconWrapper {...p} d={<><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></>} />;
        const Clock = (p) => <IconWrapper {...p} d={<><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></>} />;


        const getEmptyState = () => ({
            lastUpdated: null,
            reviews: Array(5).fill(false),
            videos: { video1: { prep: false, prod: false, pub: false }, video2: { prep: false, prod: false, pub: false } },
            clips: Array(4).fill(false),
            sheets: Array.from({ length: 10 }, () => ({ prep: false, verify: false, pub: false })),
            calls: Array(30).fill(false),
            harddrive: { prelim: false, refine: false, present: false },
            docs: { foundational: { plan: false, prep: false, pres: false }, operations: { plan: false, prep: false, pres: false }, sales: { plan: false, prep: false, pres: false }, videoEditing: { plan: false, prep: false, pres: false }, mentorship: { plan: false, prep: false, pres: false }, }
        });

        const formatLastSaved = (isoString) => {
            if (!isoString) return 'Never';
            const date = new Date(isoString);
            return new Intl.DateTimeFormat('en-US', { month: 'short', day: 'numeric', hour: 'numeric', minute: 'numeric', hour12: true }).format(date);
        };

        const Confetti = ({ active }) => {
            if (!active) return null;
            return (
                <div className="fixed inset-0 pointer-events-none z-50 overflow-hidden">
                {[...Array(50)].map((_, i) => (
                    <div key={i} className="absolute animate-fall" style={{ left: `${Math.random() * 100}%`, top: `-5%`, animationDuration: `${Math.random() * 3 + 2}s`, animationDelay: `${Math.random() * 2}s`, backgroundColor: ['#FFD700', '#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4'][Math.floor(Math.random() * 5)], width: `${Math.random() * 10 + 5}px`, height: `${Math.random() * 10 + 5}px`, transform: `rotate(${Math.random() * 360}deg)` }} />
                ))}
                </div>
            );
        };

        const App = () => {
            // --- ERROR STATE: Config Missing ---
            if (!auth || !db || (firebaseConfig.apiKey === "YOUR_API_KEY")) {
                return (
                    <div className="min-h-screen flex items-center justify-center bg-slate-50 p-6 text-center">
                        <div className="max-w-md bg-white p-8 rounded-2xl shadow-xl border-2 border-red-100">
                            <h2 className="text-2xl font-bold text-red-600 mb-4">Configuration Required</h2>
                            <p className="text-slate-600 mb-6">To run this dashboard, you need to connect it to your Firebase project.</p>
                            <div className="text-left bg-slate-100 p-4 rounded-lg text-sm font-mono mb-6 overflow-x-auto">
                                1. Open this file in a code editor<br/>
                                2. Search for "YOUR_API_KEY"<br/>
                                3. Paste your actual Firebase config
                            </div>
                            <button onClick={() => window.location.reload()} className="bg-slate-900 text-white px-6 py-2 rounded-lg hover:bg-slate-800 transition-colors">I've Updated It, Reload</button>
                        </div>
                    </div>
                );
            }

            const [user, setUser] = useState(null);
            const [data, setData] = useState(getEmptyState());
            const [isLoaded, setIsLoaded] = useState(false);
            const [showConfetti, setShowConfetti] = useState(false);
            const [isSaving, setIsSaving] = useState(false);
            const isRemoteUpdate = useRef(false);

            useEffect(() => {
                const initAuth = async () => {
                    try {
                        if (initialToken) {
                            await auth.signInWithCustomToken(initialToken);
                        } else {
                            await auth.signInAnonymously();
                        }
                    } catch (error) {
                        console.error("Auth Error:", error);
                        throw error; // Trigger global error handler
                    }
                };
                initAuth();
                return auth.onAuthStateChanged((u) => setUser(u));
            }, []);

            useEffect(() => {
                if (!user) return;
                
                // Path: /artifacts/{appId}/users/{userId}/data/tracker
                const docRef = db.collection('artifacts').doc(currentAppId).collection('users').doc(user.uid).collection('data').doc('tracker');
                
                const unsubscribe = docRef.onSnapshot((snapshot) => {
                    if (snapshot.exists) {
                        const remoteData = snapshot.data();
                        const empty = getEmptyState();
                        const mergedData = {
                            ...empty,
                            ...remoteData,
                            lastUpdated: remoteData.lastUpdated || null,
                            videos: { ...empty.videos, ...(remoteData.videos || {}) },
                            harddrive: { ...empty.harddrive, ...(remoteData.harddrive || {}) },
                            docs: { ...empty.docs, ...(remoteData.docs || {}) },
                            sheets: (Array.isArray(remoteData.sheets) && remoteData.sheets.length === 10) ? remoteData.sheets : empty.sheets
                        };
                        isRemoteUpdate.current = true;
                        setData(mergedData);
                        setTimeout(() => { isRemoteUpdate.current = false; }, 100);
                    }
                    setIsLoaded(true);
                }, (error) => { console.error("Sync error:", error); setIsLoaded(true); });
                return () => unsubscribe();
            }, [user]);

            useEffect(() => {
                if (isLoaded && user && !isRemoteUpdate.current) {
                    const saveData = async () => {
                        try {
                            const docRef = db.collection('artifacts').doc(currentAppId).collection('users').doc(user.uid).collection('data').doc('tracker');
                            await docRef.set({ ...data, lastUpdated: new Date().toISOString() }, { merge: true });
                        } catch (e) { console.error("Save error:", e); }
                    };
                    const timeoutId = setTimeout(saveData, 500);
                    return () => clearTimeout(timeoutId);
                }
            }, [data, isLoaded, user]);

            const handleManualSave = async () => {
                if (!user) return;
                setIsSaving(true);
                try {
                    const docRef = db.collection('artifacts').doc(currentAppId).collection('users').doc(user.uid).collection('data').doc('tracker');
                    await docRef.set({ ...data, lastUpdated: new Date().toISOString() }, { merge: true });
                    setTimeout(() => setIsSaving(false), 800); 
                } catch (e) { console.error("Manual save error:", e); setIsSaving(false); }
            };

            useEffect(() => {
                if (isLoaded && calculateProgress() === 100) {
                    setShowConfetti(true);
                    setTimeout(() => setShowConfetti(false), 5000);
                }
            }, [data, isLoaded]);

            const calculateProgress = () => {
                let total = 0, completed = 0;
                total += 5; completed += data.reviews.filter(Boolean).length;
                total += 6; Object.values(data.videos).forEach(v => { if (v.prep) completed++; if (v.prod) completed++; if (v.pub) completed++; });
                total += 4; completed += data.clips.filter(Boolean).length;
                total += 30; data.sheets.forEach(sheet => { if (sheet.prep) completed++; if (sheet.verify) completed++; if (sheet.pub) completed++; });
                total += 30; completed += data.calls.filter(Boolean).length;
                total += 3; if (data.harddrive.prelim) completed++; if (data.harddrive.refine) completed++; if (data.harddrive.present) completed++;
                total += 15; Object.values(data.docs).forEach(d => { if (d.plan) completed++; if (d.prep) completed++; if (d.pres) completed++; });
                return Math.round((completed / total) * 100);
            };

            const resetData = async () => {
                if (window.confirm("⚠️ WARNING: This will permanently wipe all your progress data from the cloud.\n\nAre you sure you want to reset everything to 0%?")) {
                    const freshState = getEmptyState();
                    setData(freshState);
                    setShowConfetti(false);
                    if (user) {
                        const docRef = db.collection('artifacts').doc(currentAppId).collection('users').doc(user.uid).collection('data').doc('tracker');
                        await docRef.set(freshState); 
                    }
                }
            };

            const themes = {
                blue: { bg: "bg-blue-50", border: "border-blue-200", accent: "text-blue-600", gradient: "from-blue-500 to-cyan-500", light: "bg-blue-100" },
                rose: { bg: "bg-rose-50", border: "border-rose-200", accent: "text-rose-600", gradient: "from-rose-500 to-pink-500", light: "bg-rose-100" },
                violet: { bg: "bg-violet-50", border: "border-violet-200", accent: "text-violet-600", gradient: "from-violet-500 to-purple-500", light: "bg-violet-100" },
                amber: { bg: "bg-amber-50", border: "border-amber-200", accent: "text-amber-600", gradient: "from-amber-500 to-orange-500", light: "bg-amber-100" },
                emerald: { bg: "bg-emerald-50", border: "border-emerald-200", accent: "text-emerald-600", gradient: "from-emerald-500 to-teal-500", light: "bg-emerald-100" },
                slate: { bg: "bg-slate-50", border: "border-slate-200", accent: "text-slate-600", gradient: "from-slate-700 to-gray-800", light: "bg-slate-100" },
                teal: { bg: "bg-teal-50", border: "border-teal-200", accent: "text-teal-600", gradient: "from-teal-500 to-emerald-400", light: "bg-teal-100" },
            };

            const SectionCard = ({ title, icon: Icon, children, progress, themeName = "blue" }) => {
                const theme = themes[themeName];
                return (
                    <div className={`group relative bg-white rounded-3xl shadow-lg hover:shadow-2xl transition-all duration-500 border border-white/20 overflow-hidden flex flex-col h-full ring-1 ring-slate-900/5`}>
                        <div className={`absolute top-0 left-0 w-full h-1.5 bg-gradient-to-r ${theme.gradient}`}></div>
                        <div className="p-6 border-b border-slate-100 flex justify-between items-center bg-gradient-to-b from-white to-slate-50/50">
                        <div className="flex items-center gap-4">
                            <div className={`p-3 rounded-2xl shadow-sm bg-gradient-to-br ${theme.gradient} text-white group-hover:scale-110 transition-transform duration-300`}>
                            <Icon size={20} />
                            </div>
                            <div>
                            <span className="block font-bold text-slate-800 text-lg tracking-tight">{title}</span>
                            <span className={`text-[10px] font-bold uppercase tracking-widest opacity-60 ${theme.accent}`}>In Progress</span>
                            </div>
                        </div>
                        {progress !== undefined && (
                            <div className="flex flex-col items-end">
                            <div className="relative w-12 h-12">
                                <svg className="w-full h-full" viewBox="0 0 36 36">
                                    <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#E2E8F0" strokeWidth="3" />
                                    <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="url(#gradient)" strokeWidth="3" strokeDasharray={`${progress}, 100`} className="animate-[spin_1s_ease-out_reverse]" />
                                    <defs>
                                    <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                        <stop offset="0%" stopColor="currentColor" className={theme.accent.replace('text-', 'text-')} />
                                        <stop offset="100%" stopColor="currentColor" className={theme.accent.replace('text-', 'text-')} />
                                    </linearGradient>
                                    </defs>
                                </svg>
                                <div className={`absolute inset-0 flex items-center justify-center text-xs font-bold ${theme.accent}`}>
                                    {progress}%
                                </div>
                            </div>
                            </div>
                        )}
                        </div>
                        <div className={`p-6 flex-grow ${theme.bg} bg-opacity-30`}>
                        {children}
                        </div>
                    </div>
                );
            };

            const CheckpointBtn = ({ active, onClick, label, subLabel, themeName = "emerald" }) => {
                const theme = themes[themeName];
                return (
                    <button onClick={onClick} className={`group relative flex flex-col items-center justify-center p-4 rounded-2xl border-2 transition-all duration-300 w-full outline-none focus:ring-4 focus:ring-opacity-20 ${active ? `bg-white ${theme.border} shadow-lg scale-105 ring-2 ring-offset-2 ring-${themeName}-400` : 'bg-white border-slate-100 hover:border-slate-300 hover:bg-slate-50 hover:-translate-y-1'}`}>
                        {active ? (
                        <div className={`p-2 rounded-full bg-gradient-to-br ${theme.gradient} mb-2 shadow-md`}>
                            <CheckCircle2 className="text-white" size={20} />
                        </div>
                        ) : (
                        <div className="p-2 rounded-full bg-slate-100 mb-2 group-hover:bg-slate-200 transition-colors">
                            <Circle className="text-slate-400" size={20} />
                        </div>
                        )}
                        <span className={`text-sm font-bold transition-colors ${active ? theme.accent : 'text-slate-500'}`}>{label}</span>
                        {subLabel && <span className="text-[9px] uppercase tracking-wider font-bold text-slate-300 mt-0.5">{subLabel}</span>}
                    </button>
                );
            };

            const MiniBadge = ({ active, onClick, num }) => (
                <button onClick={onClick} title={`Check: ${num}`} className={`relative h-10 text-xs font-bold rounded-xl border-b-4 transition-all active:scale-95 active:border-b-0 active:translate-y-[4px] duration-200 ${active ? 'bg-gradient-to-br from-cyan-400 to-blue-500 border-blue-700 text-white shadow-lg shadow-blue-200' : 'bg-white border-slate-200 text-slate-400 hover:border-slate-300 hover:text-slate-600'}`}>
                    {num}
                </button>
            );

            const totalPercentage = calculateProgress();

            return (
                <div className="min-h-screen bg-slate-100 font-sans selection:bg-indigo-200 text-slate-800 pb-20 overflow-x-hidden">
                    <Confetti active={showConfetti} />
                    
                    {/* Updated Sophisticated Header */}
                    <header className="relative bg-slate-900 text-white overflow-hidden mb-10 shadow-2xl">
                        {/* Animated Background Elements */}
                        <div className="absolute top-0 left-0 w-full h-full overflow-hidden z-0">
                            <div className="absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-indigo-600/30 rounded-full blur-[100px] animate-pulse"></div>
                            <div className="absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-blue-600/20 rounded-full blur-[100px] animate-pulse" style={{animationDelay: '2s'}}></div>
                        </div>

                        <div className="relative max-w-7xl mx-auto px-6 py-12 lg:py-20 z-10">
                            <div className="flex flex-col lg:flex-row items-end justify-between gap-12">
                                
                                {/* Left Side: Title & Branding */}
                                <div className="flex-1 space-y-6 text-center lg:text-left w-full">
                                    <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-indigo-500/10 border border-indigo-500/20 text-indigo-300 text-xs font-medium tracking-wider uppercase mb-2">
                                        <div className="w-2 h-2 rounded-full bg-indigo-400 animate-ping" />
                                        Dashboard
                                    </div>
                                    
                                    <h1 className="text-5xl md:text-7xl font-black tracking-tight text-white drop-shadow-sm">
                                        Exit <span className="text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 via-cyan-400 to-emerald-400">Targets</span>
                                    </h1>
                                    
                                    <div className="h-px bg-gradient-to-r from-indigo-500/30 via-white/10 to-transparent w-full max-w-xl mx-auto lg:mx-0 my-8"></div>

                                    {/* Action Bar */}
                                    <div className="flex items-center justify-center lg:justify-start gap-4 mt-8">
                                        {/* Save Button */}
                                        <button 
                                            onClick={handleManualSave}
                                            disabled={isSaving}
                                            className={`group relative px-6 py-3 rounded-xl font-bold text-sm transition-all duration-300 overflow-hidden ${
                                            isSaving 
                                                ? 'bg-emerald-500/10 text-emerald-400 cursor-wait border border-emerald-500/20' 
                                                : 'bg-white text-slate-900 hover:bg-indigo-50 hover:text-indigo-700 shadow-[0_0_20px_-5px_rgba(255,255,255,0.3)] hover:shadow-[0_0_25px_-5px_rgba(99,102,241,0.5)]'
                                            }`}
                                        >
                                            <div className="absolute inset-0 w-full h-full bg-gradient-to-r from-transparent via-white/40 to-transparent -translate-x-full group-hover:animate-shimmer"></div>
                                            <div className="flex items-center gap-2">
                                                {isSaving ? <div className="w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin" /> : <Save size={18} />}
                                                <span>{isSaving ? 'Syncing...' : 'Save Changes'}</span>
                                            </div>
                                        </button>

                                        <button onClick={resetData} className="px-6 py-3 rounded-xl font-medium text-sm text-slate-400 hover:text-white hover:bg-white/5 border border-transparent hover:border-white/10 transition-all flex items-center gap-2 group">
                                            <RotateCcw size={16} className="group-hover:-rotate-180 transition-transform duration-700" />
                                            <span>Reset</span>
                                        </button>
                                    </div>
                                    
                                    <div className="text-xs text-slate-500 font-mono mt-4 flex items-center justify-center lg:justify-start gap-2">
                                        <Clock size={12} />
                                        Last synced: <span className="text-slate-400">{formatLastSaved(data.lastUpdated)}</span>
                                    </div>
                                </div>

                                {/* Right Side: Progress Hero Card */}
                                <div className="w-full lg:w-[450px] shrink-0">
                                    <div className="relative rounded-3xl bg-slate-800/50 backdrop-blur-xl border border-white/10 p-8 overflow-hidden shadow-2xl group hover:border-white/20 transition-colors duration-500">
                                        {/* Glow effect behind card */}
                                        <div className="absolute -top-24 -right-24 w-64 h-64 bg-indigo-500/20 rounded-full blur-3xl group-hover:bg-indigo-500/30 transition-all duration-700"></div>
                                        
                                        <div className="relative z-10">
                                            <div className="flex justify-between items-start mb-8">
                                                <div>
                                                    <div className="text-sm font-medium text-slate-400 uppercase tracking-wider mb-1">Completion Rate</div>
                                                    <div className="flex items-baseline gap-1">
                                                        <span className="text-6xl font-black text-white tracking-tighter">{totalPercentage}</span>
                                                        <span className="text-2xl text-indigo-400 font-bold">%</span>
                                                    </div>
                                                </div>
                                                <div className={`p-4 rounded-2xl bg-gradient-to-br ${totalPercentage === 100 ? 'from-emerald-400 to-cyan-500 shadow-lg shadow-emerald-500/20' : 'from-slate-700 to-slate-600 border border-slate-600'}`}>
                                                    {totalPercentage === 100 ? <Trophy className="text-white animate-bounce" size={32} /> : <Activity className="text-slate-300" size={32} />}
                                                </div>
                                            </div>

                                            {/* Progress Bar */}
                                            <div className="space-y-2">
                                                <div className="flex justify-between text-xs font-medium text-slate-400">
                                                    <span>Progress</span>
                                                    <span>{totalPercentage === 100 ? 'Completed' : 'In Progress'}</span>
                                                </div>
                                                <div className="h-4 bg-slate-900/50 rounded-full overflow-hidden border border-white/5 p-[2px]">
                                                    <div className="h-full rounded-full bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 transition-all duration-1000 ease-out relative overflow-hidden" style={{ width: `${totalPercentage}%` }}>
                                                        <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-shimmer"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                        
                        {/* Bottom Fade */}
                        <div className="absolute bottom-0 left-0 w-full h-24 bg-gradient-to-t from-slate-100 to-transparent z-20"></div>
                    </header>

                    {/* Content */}
                    <main className="max-w-7xl mx-auto px-6 relative z-10">
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        
                        {/* 1. Reviews */}
                        <SectionCard title="25 Reviews" icon={Files} themeName="violet" progress={Math.round((data.reviews.filter(Boolean).length / 5) * 100)}>
                            <div className="grid grid-cols-5 gap-4">
                            {data.reviews.map((done, idx) => (
                                <CheckpointBtn 
                                key={idx}
                                active={done}
                                label={(idx + 1) * 5}
                                subLabel="REV"
                                themeName="violet"
                                onClick={() => {
                                    const newArr = [...data.reviews];
                                    newArr[idx] = !newArr[idx];
                                    setData({...data, reviews: newArr});
                                }}
                                />
                            ))}
                            </div>
                        </SectionCard>

                        {/* 2. Videos */}
                        <SectionCard title="2 Videos" icon={Video} themeName="rose" progress={Math.round((Object.values(data.videos).reduce((acc, vid) => acc + (vid.prep?1:0) + (vid.prod?1:0) + (vid.pub?1:0), 0) / 6) * 100)}>
                            <div className="space-y-6">
                                {['video1', 'video2'].map((vidKey, idx) => (
                                <div key={vidKey} className="relative bg-white rounded-2xl p-5 border border-rose-100 shadow-sm hover:shadow-md transition-shadow">
                                    <div className="flex items-center gap-2 mb-4">
                                    <div className="w-8 h-8 rounded-full bg-rose-100 flex items-center justify-center text-rose-600 font-bold text-xs">{idx + 1}</div>
                                    <h4 className="font-bold text-slate-700">Production Cycle</h4>
                                    </div>
                                    <div className="flex gap-2">
                                    {['prep', 'prod', 'pub'].map((stage) => (
                                        <button
                                        key={stage}
                                        onClick={() => setData({ ...data, videos: { ...data.videos, [vidKey]: { ...data.videos[vidKey], [stage]: !data.videos[vidKey][stage] } } })}
                                        className={`flex-1 py-3 px-2 text-xs rounded-xl font-bold transition-all border-2 ${data.videos[vidKey][stage] ? 'bg-rose-500 border-rose-500 text-white shadow-lg shadow-rose-200' : 'bg-white text-slate-400 border-slate-100 hover:border-rose-200 hover:text-rose-500'}`}
                                        >
                                        {stage === 'prep' ? 'Prep' : stage === 'prod' ? 'Prod' : 'Publish'}
                                        </button>
                                    ))}
                                    </div>
                                </div>
                                ))}
                            </div>
                        </SectionCard>

                        {/* 3. Short Clips */}
                        <SectionCard title="20 Short Clips" icon={Scissors} themeName="amber" progress={Math.round((data.clips.filter(Boolean).length / 4) * 100)}>
                            <div className="grid grid-cols-4 gap-4">
                            {data.clips.map((done, idx) => (
                                <CheckpointBtn key={idx} active={done} label={(idx + 1) * 5} themeName="amber" onClick={() => { const newArr = [...data.clips]; newArr[idx] = !newArr[idx]; setData({...data, clips: newArr}); }} />
                            ))}
                            </div>
                        </SectionCard>

                        {/* 4. Quick Review Sheets */}
                        <SectionCard title="10 Quick Review Sheets" icon={FileText} themeName="emerald" progress={Math.round((data.sheets.reduce((acc, sheet) => acc + (sheet.prep?1:0) + (sheet.verify?1:0) + (sheet.pub?1:0), 0) / 30) * 100)}>
                            <div className="grid grid-cols-1 gap-3 max-h-[380px] overflow-y-auto pr-2 custom-scrollbar">
                                {data.sheets.map((sheet, idx) => (
                                <div key={idx} className="group/item border border-emerald-100/50 rounded-xl p-3 bg-white hover:shadow-md transition-all flex items-center justify-between gap-4">
                                    <div className="flex flex-col">
                                        <span className="text-xs font-bold text-emerald-600 uppercase tracking-wider">Sheet {idx + 1}</span>
                                        <div className="flex mt-1 space-x-1">
                                            <div className={`w-2 h-2 rounded-full ${sheet.prep ? 'bg-emerald-400' : 'bg-slate-200'}`}></div>
                                            <div className={`w-2 h-2 rounded-full ${sheet.verify ? 'bg-emerald-400' : 'bg-slate-200'}`}></div>
                                            <div className={`w-2 h-2 rounded-full ${sheet.pub ? 'bg-emerald-400' : 'bg-slate-200'}`}></div>
                                        </div>
                                    </div>
                                    <div className="flex gap-1">
                                    {['prep', 'verify', 'pub'].map(stage => (
                                        <button
                                        key={stage}
                                        onClick={() => { const newSheets = [...data.sheets]; newSheets[idx] = { ...newSheets[idx], [stage]: !newSheets[idx][stage] }; setData({ ...data, sheets: newSheets }); }}
                                        className={`w-8 h-8 flex items-center justify-center rounded-lg font-bold transition-all ${sheet[stage] ? 'bg-emerald-500 text-white shadow-md shadow-emerald-200' : 'bg-slate-50 text-slate-300 hover:bg-emerald-50 hover:text-emerald-500'}`}
                                        >
                                        {stage === 'prep' ? 'P' : stage === 'verify' ? 'V' : 'D'}
                                        </button>
                                    ))}
                                    </div>
                                </div>
                                ))}
                            </div>
                        </SectionCard>

                        {/* 5. Mentorship Calls */}
                        <div className="md:col-span-2">
                            <SectionCard title="150 Mentorship Calls" icon={Phone} themeName="teal" progress={Math.round((data.calls.filter(Boolean).length / 30) * 100)}>
                            <div className="mb-6 flex items-center justify-end bg-teal-50/50 p-4 rounded-xl border border-teal-100">
                                <div className="flex items-center gap-3 text-xs font-medium text-slate-500">
                                    <div className="flex items-center gap-1"><span className="w-3 h-3 bg-gradient-to-br from-cyan-400 to-blue-500 rounded-sm"></span> Done</div>
                                    <div className="flex items-center gap-1"><span className="w-3 h-3 bg-white border border-slate-200 rounded-sm"></span> To Do</div>
                                </div>
                            </div>
                            <div className="grid grid-cols-5 sm:grid-cols-6 md:grid-cols-10 gap-3">
                                {data.calls.map((done, idx) => (
                                <MiniBadge key={idx} active={done} num={(idx + 1) * 5} onClick={() => { const newArr = [...data.calls]; newArr[idx] = !newArr[idx]; setData({...data, calls: newArr}); }} />
                                ))}
                            </div>
                            </SectionCard>
                        </div>

                        {/* 6. Harddrive */}
                        <SectionCard title="Harddrive Arrangement" icon={HardDrive} themeName="slate" progress={Math.round(((data.harddrive.prelim ? 1 : 0) + (data.harddrive.refine ? 1 : 0) + (data.harddrive.present ? 1 : 0)) / 3 * 100)}>
                            <div className="relative flex flex-col gap-4 mt-2">
                                {[
                                { key: 'prelim', label: 'Preliminary Org', desc: 'Sort raw files into folders' },
                                { key: 'refine', label: 'Refinement Phase', desc: 'Delete duplicates & rename' },
                                { key: 'present', label: 'Final Review', desc: 'Presentation to Sir' },
                                ].map((step, i) => (
                                <div 
                                    key={step.key} 
                                    className={`relative z-10 flex items-center justify-between p-4 rounded-2xl border-2 cursor-pointer transition-all duration-300 ${data.harddrive[step.key] ? 'bg-slate-800 border-slate-800 shadow-xl shadow-slate-300 transform scale-[1.02]' : 'bg-white border-slate-200 hover:border-slate-300'}`}
                                    onClick={() => setData({ ...data, harddrive: { ...data.harddrive, [step.key]: !data.harddrive[step.key] } })}
                                >
                                    <div className="flex items-center gap-4">
                                        <div className={`w-10 h-10 rounded-xl flex items-center justify-center transition-colors ${data.harddrive[step.key] ? 'bg-white/20 text-white' : 'bg-slate-100 text-slate-400'}`}>
                                            <HardDrive size={20} />
                                        </div>
                                        <div>
                                            <h5 className={`text-sm font-bold transition-colors ${data.harddrive[step.key] ? 'text-white' : 'text-slate-700'}`}>{step.label}</h5>
                                            <p className="text-xs text-slate-400">{step.desc}</p>
                                        </div>
                                    </div>
                                    <div className={`w-6 h-6 rounded-full border-2 flex items-center justify-center ${data.harddrive[step.key] ? 'border-white bg-white' : 'border-slate-300'}`}>
                                        {data.harddrive[step.key] && <CheckCircle2 size={16} className="text-slate-900" />}
                                    </div>
                                </div>
                                ))}
                            </div>
                        </SectionCard>

                        {/* 7. Docs */}
                        <div className="md:col-span-2 lg:col-span-3">
                            <SectionCard title="Documentation" icon={Layout} themeName="blue" progress={Math.round((Object.values(data.docs).reduce((acc, doc) => acc + (doc.plan?1:0) + (doc.prep?1:0) + (doc.pres?1:0), 0) / 15) * 100)}>
                            <div className="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-6">
                                {Object.entries(data.docs).map(([docType, stages]) => (
                                <div key={docType} className="bg-white rounded-2xl p-5 border border-blue-100 shadow-sm hover:shadow-lg hover:border-blue-300 transition-all duration-300 group/doc">
                                    <div className="flex items-center gap-3 mb-4 pb-3 border-b border-slate-50">
                                    <div className="p-2 rounded-lg bg-blue-50 text-blue-600 group-hover/doc:bg-blue-600 group-hover/doc:text-white transition-colors">
                                        <Activity size={16} />
                                    </div>
                                    <h3 className="capitalize font-bold text-slate-700 text-xs tracking-wider">
                                        {docType.replace(/([A-Z])/g, ' $1').trim()}
                                    </h3>
                                    </div>
                                    
                                    <div className="space-y-3">
                                    {['plan', 'prep', 'pres'].map((stage) => (
                                        <label key={stage} className="flex items-center cursor-pointer group select-none">
                                            <div className="relative">
                                            <input type="checkbox" className="peer hidden" checked={stages[stage]} onChange={() => setData({ ...data, docs: { ...data.docs, [docType]: { ...stages, [stage]: !stages[stage] } } })} />
                                            <div className={`w-6 h-6 rounded-lg border-2 flex items-center justify-center transition-all duration-300 ${stages[stage] ? 'bg-blue-500 border-blue-500 rotate-0' : 'bg-slate-50 border-slate-200 group-hover:border-blue-300 -rotate-6'}`}>
                                                <CheckCircle2 className={`text-white transition-all ${stages[stage] ? 'scale-100' : 'scale-0'}`} size={16} />
                                            </div>
                                            </div>
                                            <span className={`ml-3 text-xs font-bold transition-colors ${stages[stage] ? 'text-blue-700' : 'text-slate-400 group-hover:text-blue-500'}`}>
                                            {stage === 'plan' ? 'Planning' : stage === 'prep' ? 'Preparation' : 'Presentation'}
                                            </span>
                                        </label>
                                    ))}
                                    </div>
                                </div>
                                ))}
                            </div>
                            </SectionCard>
                        </div>
                        </div>

                        <div className="mt-12 mb-8 flex justify-center opacity-60 hover:opacity-100 transition-opacity">
                            <button onClick={resetData} className="flex items-center gap-2 px-6 py-3 rounded-full text-slate-400 hover:text-rose-600 hover:bg-rose-50 transition-all text-sm font-bold border border-transparent hover:border-rose-200">
                                <RotateCcw size={16} />
                                Reset All Dashboard Data
                            </button>
                        </div>
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>